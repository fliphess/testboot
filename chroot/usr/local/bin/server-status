#!/usr/bin/env python
import os
import os.path
import sys
import socket
import subprocess

start_msg = """
               ___
         |     |P| 
        / \    |E| 
       |--o|===|R| 
       |---|   |F|  Distro:   %s
      /     \  |M|  Kernel:   %s
     |       | |A|  Arch:     %s
     |       |=|R|  OS:       %s
     |       | |K|
     |_______| |_|
      |@| |@|  | |
    ___________|_|_

    %s

"""

def run(command):
    popen = subprocess.Popen(command.split(), stdout=subprocess.PIPE)
    popen.wait()
    return popen.stdout.read().strip().lstrip()

def getip():
    host, url = False, False
    host = '8.8.8.8'
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.connect((host, 80))
    return s.getsockname()[0]

def get_perfstatus():
    perfstatus = ''
    statusfile = '/tmp/perfstatus'
    if os.path.isfile(statusfile):
        with open(statusfile) as fh:
            perfstatus = fh.read()


def main():
    info = run('/usr/bin/w').split('\n')[0]
    distro, kernel, arch, operatingsystem = run('uname -mros').split()
    ip = getip()
    hostname = socket.gethostname()

    print start_msg % (distro, kernel, arch, operatingsystem, info)
    print "    Byte perftester"
    print "    To login press ALT ->\n"
    print "    Hostname:           %s" % socket.gethostname()
    print "    IP:                 %s" % getip()
    print "    Status:             %s" % get_perfstatus()
    print "\n"  


if __name__ == "__main__":
    main()
